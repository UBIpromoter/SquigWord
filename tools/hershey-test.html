<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Hershey Cursive - Connected Path</title>
    <style>
        body { font-family: system-ui; background: #f5f5f5; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; }
        input[type="text"] { font-size: 18px; padding: 8px 12px; width: 300px; }
        canvas { background: white; border: 1px solid #ccc; display: block; margin: 20px 0; }
        .controls { display: flex; gap: 15px; align-items: center; flex-wrap: wrap; margin-bottom: 10px; }
        button { padding: 8px 16px; cursor: pointer; }
        button.active { background: #4a9eff; color: white; }
        .debug { font-family: monospace; font-size: 11px; background: #fff; padding: 10px; border: 1px solid #ddd; max-height: 200px; overflow-y: auto; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Hershey Cursive - Single Connected Path</h1>
        <p>All letters connected into one continuous stroke for squiggle rendering</p>

        <div class="controls">
            <input type="text" id="textInput" value="squiggles">
            <label>Scale: <input type="range" id="scaleSlider" min="1" max="5" value="3"></label>
            <label>Stroke: <input type="range" id="strokeSlider" min="1" max="8" value="3"></label>
            <button id="showPointsBtn">Show Points</button>
        </div>

        <canvas id="canvas" width="1100" height="350"></canvas>

        <div class="debug" id="debug"></div>
    </div>

<script>
// Hershey Cursive letters - each as array of [x,y] points
// Main stroke only (for continuous path), secondary strokes stored separately
const LETTERS = {
    'a': {
        main: [[9,16],[8,14],[6,13],[4,13],[2,14],[1,15],[0,17],[0,19],[1,21],[3,22],[5,22],[7,21],[8,19],[10,13],[9,18],[9,21],[10,22],[11,22],[13,21],[14,20],[16,17]],
        width: 18, exitY: 17
    },
    'b': {
        main: [[4,1],[2,3],[0,8],[0,13],[1,17],[2,19],[4,21],[6,22],[8,22],[10,21],[11,19],[11,17],[10,15],[8,14],[5,14],[6,1],[6,14]],
        width: 13, exitY: 14
    },
    'c': {
        main: [[11,14],[10,13],[8,13],[5,14],[3,16],[2,18],[2,20],[3,22],[6,22],[8,21],[9,20],[11,17]],
        width: 13, exitY: 17
    },
    'd': {
        main: [[11,1],[11,22],[11,14],[10,13],[8,13],[5,14],[3,16],[2,18],[2,20],[3,22],[5,22],[8,21],[11,17],[12,22],[13,22],[15,21],[16,20],[18,17]],
        width: 20, exitY: 17
    },
    'e': {
        main: [[1,20],[3,19],[4,18],[5,16],[5,14],[4,13],[3,13],[1,14],[0,16],[0,19],[1,21],[3,22],[5,22],[7,21],[8,20],[10,17]],
        width: 12, exitY: 17
    },
    'f': {
        main: [[12,1],[10,1],[8,2],[7,4],[6,8],[6,22]],
        secondary: [[3,14],[10,14]],
        width: 14, exitY: 22
    },
    'g': {
        main: [[15,13],[15,27],[14,30],[12,31],[9,31],[7,30],[15,16],[13,14],[11,13],[8,13],[6,14],[4,16],[3,19],[3,21],[4,22],[6,22],[9,21],[11,20],[15,16],[15,19],[15,22],[16,22],[18,21],[19,20],[21,17]],
        width: 23, exitY: 17
    },
    'h': {
        main: [[4,1],[2,3],[0,8],[0,22],[0,15],[2,14],[5,13],[7,13],[9,14],[10,16],[10,19],[9,22],[10,22],[12,21],[13,20],[15,17]],
        width: 17, exitY: 17
    },
    'i': {
        main: [[4,13],[2,14],[0,17],[0,19],[1,21],[3,22],[5,22],[7,21],[8,20],[10,17]],
        dot: [4,7],
        width: 12, exitY: 17
    },
    'j': {
        main: [[6,13],[4,14],[2,17],[2,19],[3,21],[5,22],[7,22],[9,21],[10,19],[10,14],[9,22],[9,27],[8,30],[6,31],[3,31],[1,30]],
        dot: [6,7],
        width: 12, exitY: 30
    },
    'k': {
        main: [[4,1],[2,3],[0,8],[0,22],[0,18],[5,14],[8,13],[10,13],[4,17],[6,19],[8,22],[9,22],[11,21],[12,20],[14,17]],
        width: 16, exitY: 17
    },
    'l': {
        main: [[6,1],[4,3],[2,8],[1,13],[0,19],[0,21],[1,22],[3,22],[5,21],[6,20],[8,17]],
        width: 10, exitY: 17
    },
    'm': {
        main: [[4,13],[2,14],[0,17],[0,22],[0,16],[2,14],[4,13],[6,13],[8,14],[9,17],[9,22],[9,16],[11,14],[13,13],[15,13],[17,14],[18,17],[18,19],[17,22],[18,22],[20,21],[21,20],[23,17]],
        width: 25, exitY: 17
    },
    'n': {
        main: [[4,13],[2,14],[0,17],[0,22],[0,16],[2,14],[4,13],[6,13],[9,14],[10,17],[10,19],[9,22],[10,22],[12,21],[13,20],[15,17]],
        width: 17, exitY: 17
    },
    'o': {
        main: [[5,13],[3,14],[1,16],[0,19],[0,21],[1,22],[3,22],[6,21],[8,19],[9,16],[9,14],[8,13],[6,13],[4,14],[2,17],[2,19],[3,21],[5,22],[8,22],[10,21],[11,20],[13,17]],
        width: 15, exitY: 17
    },
    'p': {
        main: [[4,13],[2,14],[0,17],[0,31],[0,16],[2,14],[5,13],[7,13],[9,14],[10,16],[10,19],[9,21],[7,22],[4,22],[2,21],[0,19]],
        width: 12, exitY: 19
    },
    'q': {
        main: [[11,13],[11,31],[11,16],[9,14],[7,13],[4,13],[2,14],[1,16],[1,19],[2,21],[4,22],[7,22],[9,21],[11,19],[12,22],[13,22],[15,21],[16,20],[18,17]],
        width: 20, exitY: 17
    },
    'r': {
        main: [[4,13],[2,14],[0,17],[0,22],[0,18],[1,16],[3,14],[5,13],[8,13],[10,14]],
        width: 12, exitY: 14
    },
    's': {
        main: [[10,14],[9,13],[6,13],[3,14],[2,15],[2,16],[3,17],[6,18],[8,19],[9,20],[9,21],[8,22],[5,22],[2,21],[1,20],[0,17]],
        width: 12, exitY: 17
    },
    't': {
        main: [[6,1],[4,8],[3,13],[2,17],[2,20],[3,22],[5,22],[7,21],[8,20],[10,17]],
        crossbar: [[1,13],[8,13]],
        width: 12, exitY: 17
    },
    'u': {
        main: [[4,13],[2,14],[0,17],[0,19],[1,21],[3,22],[6,22],[8,21],[10,19],[14,13],[12,14],[10,17],[10,19],[9,22],[10,22],[12,21],[13,20],[15,17]],
        width: 17, exitY: 17
    },
    'v': {
        main: [[3,13],[1,14],[0,17],[1,20],[3,22],[5,22],[7,20],[11,13],[9,14],[7,17],[7,19],[6,22],[7,22],[9,21],[10,20],[12,17]],
        width: 14, exitY: 17
    },
    'w': {
        main: [[4,13],[2,14],[0,17],[0,19],[1,21],[3,22],[5,22],[6,21],[7,18],[10,13],[8,14],[7,17],[7,22],[10,13],[12,13],[13,14],[14,17],[14,19],[13,22],[14,22],[16,21],[17,20],[19,17]],
        width: 21, exitY: 17
    },
    'x': {
        main: [[2,13],[0,14],[4,22],[5,22],[7,21],[8,20],[10,17]],
        cross: [[10,13],[8,14],[2,22]],
        width: 12, exitY: 17
    },
    'y': {
        main: [[3,13],[1,14],[0,17],[1,20],[3,22],[5,22],[7,20],[11,13],[9,14],[7,17],[7,19],[6,22],[5,27],[3,30],[1,31],[0,31]],
        width: 13, exitY: 31
    },
    'z': {
        main: [[0,13],[10,13],[8,14],[4,22],[0,22],[4,22],[6,21],[7,20],[9,17]],
        width: 12, exitY: 17
    },
    ' ': {
        main: [],
        width: 8, exitY: 17
    }
};

const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
let showPoints = false;

document.getElementById('showPointsBtn').addEventListener('click', (e) => {
    showPoints = !showPoints;
    e.target.classList.toggle('active', showPoints);
    render();
});

function render() {
    const text = document.getElementById('textInput').value.toLowerCase();
    const scale = parseFloat(document.getElementById('scaleSlider').value);
    const strokeWidth = parseFloat(document.getElementById('strokeSlider').value);

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Build one continuous path for the entire word
    const fullPath = [];
    const secondaryPaths = []; // dots, crossbars, etc.

    let xOffset = 50;
    const yOffset = 80;
    let lastPoint = null;
    let debugInfo = [];

    for (const char of text) {
        const letter = LETTERS[char];
        if (!letter) {
            xOffset += 10 * scale;
            lastPoint = null;
            continue;
        }

        if (char === ' ') {
            xOffset += letter.width * scale;
            lastPoint = null;
            continue;
        }

        const main = letter.main;
        if (main.length === 0) continue;

        // Transform points to canvas coordinates
        const transformed = main.map(([x, y]) => [
            xOffset + x * scale,
            yOffset + y * scale
        ]);

        // First point of this letter
        const firstPt = transformed[0];

        // Add connector from last letter if needed
        if (lastPoint) {
            // Smooth connector curve
            const midX = (lastPoint[0] + firstPt[0]) / 2;
            const midY = yOffset + 20 * scale; // baseline connector height

            // Add bezier-like connector points
            fullPath.push([
                lastPoint[0] + (midX - lastPoint[0]) * 0.3,
                lastPoint[1] + (midY - lastPoint[1]) * 0.3
            ]);
            fullPath.push([midX, midY]);
            fullPath.push([
                midX + (firstPt[0] - midX) * 0.7,
                midY + (firstPt[1] - midY) * 0.7
            ]);
        }

        // Add all points from this letter
        for (const pt of transformed) {
            fullPath.push(pt);
        }

        // Track last point for next connector
        lastPoint = transformed[transformed.length - 1];

        // Handle secondary strokes
        if (letter.dot) {
            secondaryPaths.push([[xOffset + letter.dot[0] * scale, yOffset + letter.dot[1] * scale]]);
        }
        if (letter.crossbar) {
            secondaryPaths.push(letter.crossbar.map(([x, y]) => [xOffset + x * scale, yOffset + y * scale]));
        }
        if (letter.secondary) {
            secondaryPaths.push(letter.secondary.map(([x, y]) => [xOffset + x * scale, yOffset + y * scale]));
        }
        if (letter.cross) {
            secondaryPaths.push(letter.cross.map(([x, y]) => [xOffset + x * scale, yOffset + y * scale]));
        }

        debugInfo.push(`'${char}': ${main.length} pts`);
        xOffset += letter.width * scale;
    }

    debugInfo.unshift(`Total path: ${fullPath.length} points`);

    // Draw main connected path
    if (fullPath.length > 1) {
        ctx.strokeStyle = '#000';
        ctx.lineWidth = strokeWidth;
        ctx.lineCap = 'round';
        ctx.lineJoin = 'round';
        ctx.beginPath();
        ctx.moveTo(fullPath[0][0], fullPath[0][1]);
        for (let i = 1; i < fullPath.length; i++) {
            ctx.lineTo(fullPath[i][0], fullPath[i][1]);
        }
        ctx.stroke();
    }

    // Draw secondary strokes (dots, crossbars)
    ctx.strokeStyle = '#000';
    ctx.lineWidth = strokeWidth;
    for (const path of secondaryPaths) {
        if (path.length === 1) {
            // Dot
            ctx.beginPath();
            ctx.arc(path[0][0], path[0][1], strokeWidth * 1.5, 0, Math.PI * 2);
            ctx.fill();
        } else if (path.length > 1) {
            ctx.beginPath();
            ctx.moveTo(path[0][0], path[0][1]);
            for (let i = 1; i < path.length; i++) {
                ctx.lineTo(path[i][0], path[i][1]);
            }
            ctx.stroke();
        }
    }

    // Show points if enabled
    if (showPoints && fullPath.length > 0) {
        for (let i = 0; i < fullPath.length; i++) {
            const pt = fullPath[i];
            ctx.fillStyle = i === 0 ? '#00cc00' : (i === fullPath.length - 1 ? '#0066ff' : '#ff0000');
            ctx.beginPath();
            ctx.arc(pt[0], pt[1], 3, 0, Math.PI * 2);
            ctx.fill();
        }
    }

    document.getElementById('debug').textContent = debugInfo.join(' | ');
}

document.getElementById('textInput').addEventListener('input', render);
document.getElementById('scaleSlider').addEventListener('input', render);
document.getElementById('strokeSlider').addEventListener('input', render);

render();
</script>
</body>
</html>
